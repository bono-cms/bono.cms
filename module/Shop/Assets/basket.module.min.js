$(function(){$.basket={handleSuccess:function(t,e){try{var a=$.parseJSON(t);e(a)}catch(o){console.log(t),e(!1)}},recount:function(t,e,a){var o=this;$.ajax({type:"POST",url:"/module/shop/basket/re-count.ajax",data:{id:t,qty:e},beforeSend:function(){},complete:function(){},success:function(t){o.handleSuccess(t,a)}})},getStat:function(t){var e=this;$.ajax({type:"GET",url:"/module/shop/basket/get-stat.ajax",beforeSend:function(){},complete:function(){},success:function(a){e.handleSuccess(a,t)}})},add:function(t,e,a){var o=this;$.ajax({type:"POST",url:"/module/shop/basket/add.ajax",data:{id:t,qty:e},success:function(t){o.handleSuccess(t,a)}})},"delete":function(t,e){var a=this;$.ajax({type:"POST",url:"/module/shop/basket/delete.ajax",data:{id:t},success:function(t){a.handleSuccess(t,e)}})},clear:function(t){var e=this;$.ajax({type:"POST",url:"/module/shop/basket/clear.ajax",success:function(a){e.handleSuccess(a,t)}})},order:function(t){$.ajax({type:"POST",url:"/module/shop/basket/order.ajax",data:$("[data-basket-form='order']").serialize(),success:function(e){t(e)}})}};var t={updateStat:function(t){$("[data-basket-label='total-products-qty']").text(t.totalQuantity),$("[data-basket-label='total-products-price']").text(t.totalPrice)},getNodesByProductId:function(t){return $("[data-basket-product-id='"+t+"']")},getNodesByProductIdWithFilter:function(t,e){return this.getNodesByProductId(t).filter(e)},grabProductId:function(t){return $(t).data("basket-product-id")},onRemoval:function(t,e){e!==!1?0==e.totalQuantity?window.location.reload():(this.updateStat(e),$row=this.getNodesByProductIdWithFilter(t,"[data-basket-type='container']"),$row.hide(500,function(){$(this).empty()})):console.log(e)},grabQtyByProductId:function(t){var e=1,a=this.getNodesByProductIdWithFilter(t,"[data-basket-input='qty']");return a.length>0&&(e=a.val()),e}};$("[data-basket-button='order']").click(function(t){t.preventDefault(),$.basket.order(function(t){"1"==t?window.location.reload():$.validator.handleAll(t)})}),$("[data-basket-button='clear-without-confirm']").click(function(t){t.preventDefault(),$.basket.clear(function(){window.location.reload()})}),$("[data-basket-button='product-delete-with-confirm']").click(function(e){e.preventDefault();var a=t.grabProductId(this);$("[data-basket-button='product-delete-confirm-yes']").off("click").click(function(){$.basket.delete(a,function(e){t.onRemoval(a,e)})})}),$("[data-basket-button='product-delete-without-confirm']").click(function(e){e.preventDefault();var a=t.grabProductId(this);$.basket.delete(a,function(e){t.onRemoval(a,e)})}),$("[data-basket-button='product-recount']").click(function(e){e.preventDefault();var a=t.grabProductId(this),o=t.getNodesByProductId(a),n=o.filter("[data-basket-input='recount']").val();$.basket.recount(a,n,function(e){e!==!1&&(t.updateStat(e.all),o.filter("[data-basket-label='sub-total-price']").text(e.product.totalPrice))})}),$("[data-basket-button='add']").click(function(e){e.preventDefault();var a=t.grabProductId(this),o=t.grabQtyByProductId(a);$.basket.add(a,o,function(e){e!==!1?t.updateStat(e):console.log("Failure when retrieving data from a basket: "+e)})})});